{% extends "main.html" %}

{% block content %}
<section class='section-main d-flex flex-column justify-content-start align-items-center container-fluid p-4'>

    <!-- TÍTULO PRINCIPAL -->
    <h1 class="log-in h1">Actualizar Stock de Medicamento</h1>
    <h3 class="log-in h3 mb-4">Inventario en Sede: {{ item.id_sede.nom_sede }}</h3>

    <!-- MENSAJES -->
    {% if messages %}
        {% for m in messages %}
        <div class="alert alert-{{ m.tags }} alert-dismissible fade show w-75" role="alert">
            {{ m }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        {% endfor %}
    {% endif %}

    <!-- DETALLES DEL MEDICAMENTO Y FORMULARIO -->
    <div class="identification w-50 p-5 mb-5 bg-white shadow-lg rounded-3">
        <h4 class="log_title mb-3 border-bottom pb-2">Medicamento: {{ item.cod_med.nom_med }} ({{ item.cod_med.cod_med }})</h4>
        <p class="text-muted mb-4">{{ item.cod_med.descripcion }}</p>
        
        <form method="POST" action="{% url 'cashier:actualizar_stock' item.pk %}" class="row g-4">
            {% csrf_token %}
            
            <div class="col-12">
                <label for="{{ form.stock_actual.id_for_label }}" class="title form-label">Stock Actual</label>
                {{ form.stock_actual }}
                {% if form.stock_actual.errors %}
                    <small class="text-danger">{{ form.stock_actual.errors }}</small>
                {% endif %}
                <small class="form-text text-muted">Cantidad disponible en la farmacia de esta sede.</small>
            </div>
            
            <!-- Campos ocultos o no editables si el formulario incluye campos como id_sede o cod_med -->
            {% for field in form.hidden_fields %}
                {{ field }}
            {% endfor %}

            <div class="col-12 mt-5 text-center">
                <button type="submit" class="btn btn-primary btn-lg me-3">
                    <i class="bi bi-save me-2"></i> Guardar Actualización
                </button>
                <a href="{% url 'cashier:gestion_farmacia' %}" class="btn btn-outline-secondary btn-lg">
                    <i class="bi bi-arrow-left me-2"></i> Volver a Inventario
                </a>
            </div>
        </form>
    </div>

</section>
{% endblock content %}