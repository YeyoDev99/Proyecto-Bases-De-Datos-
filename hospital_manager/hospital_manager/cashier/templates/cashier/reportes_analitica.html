{% extends 'main.html' %}
{% load static %}

{% block content %}
<div class="container-fluid">
    <!-- Header -->
    <div class="row py-3" style="background-color: #84407b;">
        <div class="col-md-6">
            <a href="{% url 'hospital:dashboard' %}" class="text-white text-decoration-none"
                style="font-family: 'Pixelify Sans'; font-size: 1.5rem;">
                <i class="bi bi-hospital"></i> HIS+ | Reportes y Analítica
            </a>
        </div>
        <div class="col-md-6 text-end">
            <a href="{% url 'hospital:dashboard' %}" class="exit"><i class="bi bi-arrow-left"></i> Menú</a>
            <a href="{% url 'hospital:logout' %}" class="exit ms-3"><i class="bi bi-box-arrow-right"></i> Salir</a>
        </div>
    </div>

    {% if messages %}
    <div class="row mt-2">
        <div class="col-12">
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <div class="row mt-4 justify-content-center">
        <div class="col-md-11">
            <div class="menu-container">
                {% if datos %}
                <!-- Resultados del Reporte -->
                <h4><i class="bi bi-graph-up"></i>
                    {% if tipo == 'medicamentos' %}Medicamentos más Recetados
                    {% elif tipo == 'medicos' %}Médicos con más Consultas
                    {% elif tipo == 'tiempos' %}Tiempos de Atención
                    {% elif tipo == 'enfermedades' %}Pacientes por Enfermedad
                    {% elif tipo == 'equipamiento' %}Equipamiento Compartido
                    {% elif tipo == 'trimestre' %}Enfermedades del Trimestre
                    {% elif tipo == 'consumo' %}Consumo de Medicamentos
                    {% elif tipo == 'recursos' %}Utilización de Recursos
                    {% elif tipo == 'indices' %}Índices de Atención
                    {% elif tipo == 'especialidades' %}Especialidades Demandadas
                    {% elif tipo == 'inventario' %}Inventario Crítico
                    {% elif tipo == 'productividad' %}Productividad Médicos
                    {% elif tipo == 'tendencias' %}Tendencias de Enfermedades
                    {% else %}Resultados del Reporte{% endif %}
                </h4>

                <a href="{% url 'hospital:menu_reportes' %}" class="exit mb-3"><i class="bi bi-arrow-left"></i> Ver
                    todos los reportes</a>

                <div class="table-responsive mt-3">
                    <table class="table" style="font-family: 'Pixelify Sans';">
                        <thead>
                            <tr class="title">
                                {% if tipo == 'medicamentos' %}
                                <th>Sede</th>
                                <th>Ciudad</th>
                                <th>Medicamento</th>
                                <th>Total Prescripciones</th>
                                <th>Cantidad Recetada</th>
                                {% elif tipo == 'medicos' %}
                                <th>Médico</th>
                                <th>Sede</th>
                                <th>Departamento</th>
                                <th>Especialidad</th>
                                <th>Semana</th>
                                <th>Consultas</th>
                                {% elif tipo == 'tiempos' %}
                                <th>Sede</th>
                                <th>Departamento</th>
                                <th>Horas Promedio</th>
                                <th>Total Casos</th>
                                {% elif tipo == 'enfermedades' %}
                                <th>Sede</th>
                                <th>Enfermedad</th>
                                <th>Total Pacientes</th>
                                <th>Total Diagnósticos</th>
                                {% elif tipo == 'equipamiento' %}
                                <th>Equipo</th>
                                <th>Marca</th>
                                <th>Sede</th>
                                <th>Departamento</th>
                                <th>Estado</th>
                                {% elif tipo == 'trimestre' %}
                                <th>Departamento</th>
                                <th>Sede</th>
                                <th>Enfermedad</th>
                                <th>Total Casos</th>
                                {% elif tipo == 'indices' %}
                                <th>Sede</th>
                                <th>Total Citas</th>
                                <th>Días Espera Promedio</th>
                                {% elif tipo == 'especialidades' %}
                                <th>Especialidad</th>
                                <th>Sede</th>
                                <th>Total Consultas</th>
                                {% else %}
                                {% for i in datos.0 %}<th>Col {{ forloop.counter }}</th>{% endfor %}
                                {% endif %}
                            </tr>
                        </thead>
                        <tbody>
                            {% for row in datos %}
                            <tr class="text">
                                {% for col in row %}
                                <td>{{ col }}</td>
                                {% endfor %}
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="10" class="text text-center">No hay datos para mostrar</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>

                {% else %}
                <!-- Menú de Reportes -->
                <h4><i class="bi bi-graph-up"></i> Reportes y Analítica</h4>

                <div class="row mt-4">
                    <div class="col-12">
                        <h5 class="title">Reportes Principales del Proyecto</h5>
                    </div>
                    <div class="col-md-4 mt-3">
                        <a href="{% url 'hospital:reporte_medicamentos_recetados' %}"
                            class="identification d-block text-decoration-none p-3">
                            <i class="bi bi-capsule text" style="font-size: 2rem;"></i>
                            <div class="title mt-2">Medicamentos Recetados</div>
                            <small class="text">Por sede, último mes</small>
                        </a>
                    </div>
                    <div class="col-md-4 mt-3">
                        <a href="{% url 'hospital:reporte_medicos_consultas' %}"
                            class="identification d-block text-decoration-none p-3">
                            <i class="bi bi-person-badge text" style="font-size: 2rem;"></i>
                            <div class="title mt-2">Médicos con más Consultas</div>
                            <small class="text">Ranking semanal</small>
                        </a>
                    </div>
                    <div class="col-md-4 mt-3">
                        <a href="{% url 'hospital:reporte_tiempos_atencion' %}"
                            class="identification d-block text-decoration-none p-3">
                            <i class="bi bi-clock-history text" style="font-size: 2rem;"></i>
                            <div class="title mt-2">Tiempos de Atención</div>
                            <small class="text">Promedio cita-diagnóstico</small>
                        </a>
                    </div>
                    <div class="col-md-4 mt-3">
                        <a href="{% url 'hospital:reporte_pacientes_enfermedad' %}"
                            class="identification d-block text-decoration-none p-3">
                            <i class="bi bi-virus text" style="font-size: 2rem;"></i>
                            <div class="title mt-2">Pacientes por Enfermedad</div>
                            <small class="text">Por sede</small>
                        </a>
                    </div>
                    <div class="col-md-4 mt-3">
                        <a href="{% url 'hospital:reporte_equipamiento_compartido' %}"
                            class="identification d-block text-decoration-none p-3">
                            <i class="bi bi-gear text" style="font-size: 2rem;"></i>
                            <div class="title mt-2">Equipamiento Compartido</div>
                            <small class="text">Entre sedes</small>
                        </a>
                    </div>
                </div>

                <div class="row mt-4">
                    <div class="col-12">
                        <h5 class="title">Reportes Adicionales</h5>
                    </div>
                    <div class="col-md-3 mt-3">
                        <a href="{% url 'hospital:reporte_enfermedades_trimestre' %}"
                            class="identification d-block text-decoration-none p-3 text-center">
                            <i class="bi bi-calendar3 text"></i>
                            <div class="title mt-1" style="font-size: 1rem;">Enfermedades Trimestre</div>
                        </a>
                    </div>
                    <div class="col-md-3 mt-3">
                        <a href="{% url 'hospital:reporte_consumo_medicamentos' %}"
                            class="identification d-block text-decoration-none p-3 text-center">
                            <i class="bi bi-graph-down text"></i>
                            <div class="title mt-1" style="font-size: 1rem;">Consumo Medicamentos</div>
                        </a>
                    </div>
                    <div class="col-md-3 mt-3">
                        <a href="{% url 'hospital:reporte_utilizacion_recursos' %}"
                            class="identification d-block text-decoration-none p-3 text-center">
                            <i class="bi bi-pie-chart text"></i>
                            <div class="title mt-1" style="font-size: 1rem;">Utilización Recursos</div>
                        </a>
                    </div>
                    <div class="col-md-3 mt-3">
                        <a href="{% url 'hospital:reporte_indices_atencion' %}"
                            class="identification d-block text-decoration-none p-3 text-center">
                            <i class="bi bi-speedometer2 text"></i>
                            <div class="title mt-1" style="font-size: 1rem;">Índices Atención</div>
                        </a>
                    </div>
                    <div class="col-md-3 mt-3">
                        <a href="{% url 'hospital:reporte_especialidades_demandadas' %}"
                            class="identification d-block text-decoration-none p-3 text-center">
                            <i class="bi bi-award text"></i>
                            <div class="title mt-1" style="font-size: 1rem;">Especialidades</div>
                        </a>
                    </div>
                    <div class="col-md-3 mt-3">
                        <a href="{% url 'hospital:reporte_inventario_critico' %}"
                            class="identification d-block text-decoration-none p-3 text-center">
                            <i class="bi bi-exclamation-diamond text"></i>
                            <div class="title mt-1" style="font-size: 1rem;">Inventario Crítico</div>
                        </a>
                    </div>
                    <div class="col-md-3 mt-3">
                        <a href="{% url 'hospital:reporte_productividad_medicos' %}"
                            class="identification d-block text-decoration-none p-3 text-center">
                            <i class="bi bi-bar-chart text"></i>
                            <div class="title mt-1" style="font-size: 1rem;">Productividad</div>
                        </a>
                    </div>
                    <div class="col-md-3 mt-3">
                        <a href="{% url 'hospital:reporte_tendencias_enfermedades' %}"
                            class="identification d-block text-decoration-none p-3 text-center">
                            <i class="bi bi-graph-up-arrow text"></i>
                            <div class="title mt-1" style="font-size: 1rem;">Tendencias</div>
                        </a>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock content %}